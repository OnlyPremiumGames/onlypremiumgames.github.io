<!DOCTYPE html>
<html lang="en">

<head>
    <meta charset="utf-8">
    <meta name="viewport" content="width=device-width, initial-scale=1">
    <meta property="og:title" content="Only Premium Games">
    <meta property="og:image" content="https://onlypremium.games/img/logo.png">
    <title>Only Premium Games</title>
    <link rel="icon" href="img/favicon.ico" sizes="32x32">
    <link rel="icon" href="img/icon.svg" type="image/svg+xml">
    <link rel="apple-touch-icon" href="img/icon180.png">
    <link rel="stylesheet" type="text/css" href="https://cdnjs.cloudflare.com/ajax/libs/normalize/8.0.1/normalize.css">
    <link rel="stylesheet" type="text/css" href="https://cdnjs.cloudflare.com/ajax/libs/milligram/1.4.1/milligram.css">
    <link rel="stylesheet" type="text/css" href="/css/style.css">
    <script defer src="https://cdn.jsdelivr.net/npm/alpinejs@3.x.x/dist/cdn.min.js"></script>
    <script defer async data-host="onlypremium.games" src="https://liteanalytics.com/lite.js"></script>
</head>

<body>
    <div x-data="{ headerHTML: '' }"
        x-init="fetch('/partials/header.html').then(r => r.text()).then(html => headerHTML = html)">
        <div x-html="headerHTML"></div>
    </div>

    <main class="container">

        <h3>About</h3>
        <div x-data="{ headerHTML: '' }"
            x-init="fetch('/partials/about.html').then(r => r.text()).then(html => headerHTML = html)">
            <div x-html="headerHTML"></div>
        </div>

        <h3>
            List
            &nbsp;&nbsp;&nbsp;
            <a href="blog.html">Blog</a>
            &nbsp;&nbsp;&nbsp;
            <a href="beta.html">Beta</a>
            &nbsp;&nbsp;&nbsp;
            <a href="contact.html">Contact</a>
        </h3>

        <div x-data="{
                      games: [],
                      search: '',
                      count: 15,
                      showMore: false,
                      get filteredGames() {
                        let result = this.games.filter(g => g.title.toLowerCase().includes(this.search.toLowerCase()));
                        this.showMore = result.length > this.count;
                        return result.splice(0, Math.min(result.length, this.count));
                      },
                      resetCount() {
                        this.count = 15;
                      }
                      }" x-init="games = await (await fetch('/data/list.json')).json();">
            <input type="text" x-model="search" placeholder="Search..." x-on:input="resetCount">

            <table>
                <template x-if="games.length > 0">
                    <template x-for="game in filteredGames">
                        <tbody>
                            <tr>
                                <template x-if="game.hasOwnProperty('icon')">
                                    <td class="app-icon"
                                        x-bind:class="game.hasOwnProperty('rating') ? 'no-border' : ''">
                                        <img x-bind:src="game.icon" x-bind:alt="game.id" x-bind:title="game.id"></img>
                                    </td>
                                </template>
                                <template x-if="!game.hasOwnProperty('icon')">
                                    <td x-bind:class="game.hasOwnProperty('rating') ? 'no-border' : ''">
                                        <span x-html="game.id"></span>
                                    </td>
                                </template>

                                <template x-if="game.hasOwnProperty('link')">
                                    <td x-bind:class="game.hasOwnProperty('rating') ? 'no-border' : ''">
                                        <a x-bind:href="game.link" target="_blank">
                                            <span x-html="game.title"></span>
                                        </a>
                                    </td>
                                </template>
                                <template x-if="!game.hasOwnProperty('link')">
                                    <td x-bind:class="game.hasOwnProperty('rating') ? 'no-border' : ''">
                                        <span x-html="game.title"></span>
                                    </td>
                                </template>

                                <template x-if="game.hasOwnProperty('date')">
                                    <td class="date" x-bind:class="game.hasOwnProperty('rating') ? 'no-border' : ''">
                                        <span x-html="convertDate(game.date)"></span>
                                    </td>
                                </template>
                                <template x-if="!game.hasOwnProperty('date')">
                                    <td></td>
                                </template>
                            </tr>
                            <template x-if="game.hasOwnProperty('verdict')">
                                <tr>
                                    <td x-bind:class="game.hasOwnProperty('rating') ? 'no-border' : ''"></td>
                                    <td colspan="2" x-bind:class="game.hasOwnProperty('rating') ? 'no-border' : ''">
                                        <span x-html="game.verdict"></span>
                                    </td>
                                </tr>
                            </template>
                            <template x-if="game.hasOwnProperty('rating')">
                                <tr x-data="{ length: game.rating.length }">
                                    <td class="rating" colspan="4">
                                        <template x-for="i in 5">
                                            <span>
                                                <template x-if="i <= length"><span>&#9733;</span></template>
                                                <template x-if="i > length"><span>&#9734;</span></template>
                                            </span>
                                        </template>
                                        <template x-if="length == 6">
                                            <span class="editors-choice">
                                                <img src="img/olive-left.svg"></img>
                                                <strong>Editor's Choice</strong>
                                                <img src="img/olive-right.svg"></img>
                                            </span>
                                        </template>
                                    </td>
                                </tr>
                            </template>
                        </tbody>
                    </template>
                </template>
                <tfoot>
                    <tr>
                        <td class="no-border" colspan="4">
                            <span class="buttons">
                                <a class="button button-color float-left" x-show="showMore" x-on:click="count += 15">
                                    More ...
                                </a>
                                <a class="button button-color float-right" x-on:click="scrollTop">
                                    &uarr;
                                </a>
                            </span>
                        </td>
                    </tr>
                </tfoot>
            </table>
        </div>

        <script>
            function convertDate(jsonDate) {
                let dateObject = new Date(Date.parse(jsonDate));
                return dateObject.toLocaleDateString();
            }
        </script>

        <script>
            function scrollTop() {
                document.body.scrollTop = 0; // For Safari
                document.documentElement.scrollTop = 0; // For Chrome, Firefox, IE and Opera
            }       
        </script>

    </main>

    <footer>
        Built with <a href="https://milligram.io" target="_blank">Milligram</a>
        and <a href="https://alpinejs.dev" target="_blank">Alpine.js</a>
        by <a href="https://bsky.app/profile/keyplayermaek.bsky.social" target="_blank">Marek Toth</a>
    </footer>

</body>

</html>